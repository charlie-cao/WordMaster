# 🛠️ WordMaster 开发指南

## 🚀 快速开始

### 方法一：自动配置（推荐）
```bash
# 1. 克隆项目
git clone git@github.com:charlie-cao/WordMaster.git
cd WordMaster

# 2. 自动配置开发环境
npm run setup

# 3. 启动开发服务器
npm run dev
```

### 方法二：手动配置
```bash
# 1. 安装依赖
npm install

# 2. 启动 MongoDB
npm run docker:up

# 3. 配置环境变量
cp env.example .env.local
# 编辑 .env.local 文件

# 4. 初始化数据库
npm run seed
npm run create-wordsets

# 5. 启动开发服务器
npm run dev
```

## 📁 项目结构详解

```
wordmaster/
├── src/
│   ├── app/                    # Next.js App Router
│   │   ├── (pages)/           # 页面组件
│   │   │   ├── auth/          # 认证页面
│   │   │   ├── dashboard/     # 仪表板
│   │   │   ├── study/         # 学习页面
│   │   │   ├── words/         # 单词库
│   │   │   └── stats/         # 统计页面
│   │   ├── api/               # API 路由
│   │   │   ├── auth/          # 认证相关API
│   │   │   ├── words/         # 单词相关API
│   │   │   └── wordsets/      # 单词本API
│   │   ├── globals.css        # 全局样式
│   │   └── layout.tsx         # 根布局
│   ├── components/            # React 组件
│   │   ├── ui/               # 基础 UI 组件
│   │   ├── charts/           # 图表组件
│   │   └── Header.tsx        # 通用导航组件
│   ├── lib/                  # 工具库
│   │   ├── models/           # 数据模型
│   │   ├── services/         # 业务逻辑服务
│   │   ├── mongodb.ts        # 数据库连接
│   │   ├── auth.ts           # 认证工具
│   │   └── utils.ts          # 通用工具函数
│   ├── hooks/                # 自定义 React Hooks
│   │   └── useAuth.ts        # 认证状态管理
│   └── types/                # TypeScript 类型定义
├── scripts/                  # 脚本文件
│   ├── seed.ts              # 数据库种子数据
│   ├── extended-words.ts    # 扩展单词数据
│   ├── create-wordsets.ts   # 创建单词本
│   ├── reset-db.ts          # 重置数据库
│   └── dev-setup.js         # 开发环境配置
├── docs/                    # 项目文档
├── public/                  # 静态资源
├── docker-compose.yml       # 开发环境 Docker 配置
├── docker-compose.prod.yml  # 生产环境 Docker 配置
├── Dockerfile              # Docker 镜像配置
└── package.json            # 项目配置
```

## 🔧 开发命令

### 基础命令
```bash
npm run dev          # 启动开发服务器
npm run build        # 构建生产版本
npm run start        # 启动生产服务器
npm run lint         # 代码检查
npm run type-check   # TypeScript 类型检查
```

### Docker 命令
```bash
npm run docker:up    # 启动开发环境 Docker 服务
npm run docker:down  # 停止 Docker 服务
npm run docker:prod  # 启动生产环境 Docker 服务
```

### 数据库命令
```bash
npm run seed            # 初始化单词数据
npm run create-wordsets # 创建预设单词本
npm run reset-db        # 重置数据库
npm run setup           # 完整环境配置
```

## 🗄️ 数据库设计

### 核心集合

#### Users (用户)
```typescript
{
  _id: ObjectId,
  email: string,
  username: string,
  password: string, // 加密存储
  settings: UserSettings,
  stats: UserStats,
  createdAt: Date,
  updatedAt: Date
}
```

#### Words (单词)
```typescript
{
  _id: ObjectId,
  word: string,
  pronunciation: string,
  definitions: WordDefinition[],
  difficulty: 'easy' | 'medium' | 'hard',
  frequency: number,
  tags: string[],
  createdAt: Date,
  updatedAt: Date
}
```

#### UserWordProgress (学习进度)
```typescript
{
  _id: ObjectId,
  userId: ObjectId,
  wordId: ObjectId,
  status: 'learning' | 'reviewing' | 'mastered',
  correctCount: number,
  incorrectCount: number,
  lastReviewedAt: Date,
  nextReviewAt: Date,
  difficulty: number,
  notes?: string
}
```

## 🔌 API 接口文档

### 认证相关
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/logout` - 退出登录
- `GET /api/auth/me` - 获取当前用户信息

### 单词相关
- `GET /api/words` - 获取单词列表（支持分页、筛选）
- `GET /api/words/random` - 获取随机单词
- `GET /api/words/categories` - 获取分类统计
- `GET /api/wordsets` - 获取单词本列表
- `POST /api/wordsets` - 创建单词本

### 请求示例
```javascript
// 获取单词列表
fetch('/api/words?page=1&limit=10&difficulty=medium')

// 获取随机单词
fetch('/api/words/random?count=5&difficulty=easy')

// 用户登录
fetch('/api/auth/login', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ email, password })
})
```

## 🎨 UI 组件开发

### 设计系统
- **颜色**: 蓝紫渐变主题
- **圆角**: rounded-xl (12px)
- **阴影**: shadow-lg, shadow-xl
- **动画**: transition-all duration-300
- **背景**: 毛玻璃效果 backdrop-blur-sm

### 组件规范
```typescript
// 按钮样式
<Button className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">

// 卡片样式
<Card className="bg-white/80 backdrop-blur-sm border-0 shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">

// 背景装饰
<div className="absolute inset-0 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
  <div className="absolute top-20 left-10 w-96 h-96 bg-blue-300 rounded-full mix-blend-multiply filter blur-xl opacity-10 animate-pulse"></div>
</div>
```

## 🔍 调试指南

### 常见问题

#### 1. MongoDB 连接失败
```bash
# 检查 Docker 容器状态
docker ps

# 重启 MongoDB
npm run docker:down
npm run docker:up
```

#### 2. 环境变量问题
```bash
# 检查环境变量文件
cat .env.local

# 重新创建环境变量
cp env.example .env.local
```

#### 3. 数据库数据问题
```bash
# 重置并重新初始化数据库
npm run reset-db
npm run seed
npm run create-wordsets
```

### 开发工具
- **数据库管理**: http://localhost:8081 (Mongo Express)
- **API测试**: 使用 Postman 或 curl
- **日志查看**: 浏览器开发者工具 Console

## 🧪 测试指南

### 手动测试流程
1. **用户认证测试**
   - 注册新用户
   - 登录验证
   - 退出登录

2. **学习功能测试**
   - 单词学习流程
   - 进度统计
   - 数据可视化

3. **API测试**
   - 单词获取
   - 用户认证
   - 数据统计

### API 测试示例
```bash
# 测试单词API
curl http://localhost:3000/api/words

# 测试分类API
curl http://localhost:3000/api/words/categories

# 测试用户注册
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"test","email":"test@example.com","password":"password123","confirmPassword":"password123"}'
```

## 📦 部署指南

### 开发环境
```bash
npm run docker:up  # 启动开发环境
npm run dev        # 启动开发服务器
```

### 生产环境
```bash
npm run build        # 构建应用
npm run docker:prod  # 启动生产环境
```

### 环境变量配置
生产环境需要设置以下环境变量：
- `MONGODB_URI` - MongoDB 连接字符串
- `JWT_SECRET` - JWT 密钥
- `NEXTAUTH_SECRET` - NextAuth 密钥
- `NEXTAUTH_URL` - 应用URL

## 🤝 贡献指南

### 代码规范
- 使用 TypeScript 严格模式
- 遵循 ESLint 规则
- 组件使用 PascalCase 命名
- 文件使用 camelCase 命名

### 提交规范
```bash
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 样式调整
refactor: 代码重构
test: 测试相关
chore: 构建过程或辅助工具的变动
```

### 开发流程
1. Fork 项目
2. 创建功能分支
3. 本地开发和测试
4. 提交 Pull Request

## 📚 相关文档

- [项目总结](./项目总结.md) - 完整的项目实现总结
- [UI优化总结](./UI优化总结.md) - UI设计和优化过程
- [单词库扩展总结](./单词库扩展总结.md) - 单词数据扩展详情
- [UI问题修复总结](./UI问题修复总结.md) - 问题修复记录

## 💡 开发技巧

### 1. 快速重启开发环境
```bash
npm run docker:down && npm run docker:up
npm run dev
```

### 2. 数据库快速重置
```bash
npm run reset-db && npm run seed && npm run create-wordsets
```

### 3. 样式调试
- 使用浏览器开发者工具
- 检查 Tailwind CSS 类是否生效
- 验证响应式断点

### 4. API调试
- 查看 Network 面板
- 检查 Console 错误日志
- 使用 MongoDB Compass 查看数据

---

**最后更新**: 2025年9月18日  
**维护者**: WordMaster Team  
**联系方式**: 项目 Issues 页面
